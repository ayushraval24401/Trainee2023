<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JExcel Task</title>
    <script src="https://bossanova.uk/jspreadsheet/v4/jexcel.js"></script>
    <link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v4/jexcel.css" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js" integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <script src="https://jsuites.net/v4/jsuites.js"></script>
    <link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css" />
     
</head>
<body>
    <div id="spreadsheet2"></div>
    <div class="text-center"><button class="btn-danger" onclick="table1.deleteRow()" id="deleterow">Delete Last Row</button><br>
    </div><br>
<div class="text-center"><input type="text" id="rowinput">
<button type="button" class="btn-primary" id="addrow" onclick="insertRows()">Add Row</button>
</div><br>
<div>
<table class="table table-light" id="table">
    <thead>
      <tr>
        <th scope="col">SR no</th>
        <th scope="col">Project Name</th>
        <th scope="col">Timelog Date</th>
        <th scope="col">Phase</th>
        <th scope="col">Status</th>
        <th scope="col">Logged Hours</th>
        <th scope="col">Billable Hours</th>
        <th scope="col">Notes</th>
        <th scope="col">Status</th>
        <th scope="col">Out of stock</th>
        <th scope="col">Bc link</th>
        <th scope="col">Bc description</th>
       
      </tr>
    </thead>
    <tbody id="tbl">
      
    </tbody>
  </table>
</div>
    <script>
       
        // var data2 = new Array()
       var  data2 =[ 
         ['','','']
        ];
        
        function insertRows(){
            var rowInput = document.getElementById('rowinput').value;
            debugger;
            table1.insertRow(Number(rowInput));
        }

       
   
        // var AppendRow = function (){
        //     debugger;
        //     for(let i=0; i < data2.length; i++){
        //         let row = "<tr>";
        //         let cell = "";
        //         for(let j=0; j < data2[i].length; j++){
        //             let value = data2[i][j];
        //             cell = cell + '<td>' + value + '</td>'
        //             console.log(value);
        //         }
        //         row = row + cell + '</tr>';
        //         $('#tbl').append(row);
        //     }
        // }
       

// $('#tbl').append(value);
    


 
        var table1 = jspreadsheet(document.getElementById('spreadsheet2'), {
     data:data2,
    columns: [
        { type:'dropdown', title:'Project Name', width:'150', source:['intern','junior','senior'] },
        { type:'calendar', title:'Timelog Date', width:'100' },
        { type: 'dropdown', title:'Phase', width:'100', source:['Analysis', 'Design','Development'] },
        { type: 'dropdown', title:'Status', width:'100', source:['Working', 'Pending','Solved'] },
        { type: 'text', title:'Logged Hours', width:'120', mask:'hh:mm' },
        { type: 'text', title:'Billable Hours', width:'120',mask:'hh:mm'},
        { type: 'text', title:'Notes',  width:'200' },
        { type: 'checkbox', title:'Out of stock', width:'100' },
        { type: 'text', title:'Bc Link', width:'80' },
        { type: 'text', title:'Description', width:'200' },
    ],
    // onchange: AppendRow,
    updateTable: function (instance, cell, col, row, val, label, cellName) {
var r = cellName;
var html = "";

    
        data2.forEach(function (value, index) {
            if(col == 6 && cell.innerText != ''){
            var a = index + 1;
            html += "<tr class=text-center>";
            html += "<td>" + a + "</td>";
            html += "<td>" + (value)[0] + "</td>";
            html += "<td>" + (value)[1] + "</td>";
            html += "<td>" + (value)[2] + "</td>";
            html += "<td>" +  (value)[3]+ "</td>";
            html += "<td>" + (value)[4] + "</td>";
            html += "<td>" +(value)[5]  + "</td>";
            html += "<td>" + (value)[6] + "</td>";
            html += "<td>" + (value)[7] + "</td>";
            html += "<td>" +(value)[8] + "</td>";
            html += "<td>" + (value)[9]+ "</td>";
            


            html += "</tr>";

            document.getElementById("tbl").innerHTML = html;
        }
});

}

});
console.log(data2);
    // onchange:function(instance, cell, c, r, value) {
    //     if (c == 0) {
    //         var columnName = jspreadsheet.getColumnNameFromId([c + 1, r]);
    //         instance.jexcel.setValue(columnName, '');
    //     }
    // }
// });








        </script>
</body>
</html>